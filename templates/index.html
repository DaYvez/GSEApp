{% extends "base.html" %}

{% block title %}Inventory Management - Green Super Electronics{% endblock %}

{% block styles %}
<style>
    .table {
        background-color: #1a1d20;
        color: #ffffff;
    }
    .table thead {
        background-color: #212529 !important;
    }
    .table thead th {
        background-color: #212529;
        border-color: #495057;
        color: #ffffff;
    }
    .table tbody {
        background-color: #1a1d20;
    }
    .table tbody tr {
        background-color: #1a1d20;
        border-color: #495057;
    }
    .table tbody tr:hover {
        background-color: #2c3034;
    }
    .table td {
        border-color: #495057;
        background-color: #1a1d20;
        color: #ffffff;
    }
    .card {
        background-color: #1a1d20;
        border-color: #495057;
    }
    .card-body {
        background-color: #1a1d20;
    }
    .sold-item {
        background-color: #2c3034 !important;
        opacity: 0.8;
    }
    .sold-item:hover {
        background-color: #343a40 !important;
    }
    .sold-item td {
        background-color: #2c3034 !important;
        color: #e9ecef;
    }
    .sold-item:hover td {
        background-color: #343a40 !important;
    }
    .text-decoration-none {
        color: #ffffff !important;
    }
    .text-decoration-none:hover {
        color: #0dcaf0 !important;
    }
    .btn-outline-info {
        color: #0dcaf0;
        border-color: #0dcaf0;
    }
    .btn-outline-info:hover {
        color: #fff;
        background-color: #0dcaf0;
        border-color: #0dcaf0;
    }
    .btn-outline-warning {
        color: #ffc107;
        border-color: #ffc107;
    }
    .btn-outline-warning:hover {
        color: #000;
        background-color: #ffc107;
        border-color: #ffc107;
    }
    .btn-outline-danger {
        color: #dc3545;
        border-color: #dc3545;
    }
    .btn-outline-danger:hover {
        color: #fff;
        background-color: #dc3545;
        border-color: #dc3545;
    }
    .btn-outline-success {
        color: #198754;
        border-color: #198754;
    }
    .btn-outline-success:hover {
        color: #fff;
        background-color: #198754;
        border-color: #198754;
    }
    .alert {
        background-color: #1a1d20;
        border-color: #495057;
        color: #ffffff;
    }
    .alert-success {
        background-color: #1a1d20;
        border-color: #198754;
        color: #198754;
    }
    .alert-danger {
        background-color: #1a1d20;
        border-color: #dc3545;
        color: #dc3545;
    }
    .alert-warning {
        background-color: #1a1d20;
        border-color: #ffc107;
        color: #ffc107;
    }
    .alert-info {
        background-color: #1a1d20;
        border-color: #0dcaf0;
        color: #0dcaf0;
    }
    .alert-primary {
        background-color: #1a1d20;
        border-color: #0d6efd;
        color: #0d6efd;
    }
    .alert-secondary {
        background-color: #1a1d20;
        border-color: #6c757d;
        color: #6c757d;
    }
    .modal-content {
        background-color: #1a1d20;
        border-color: #495057;
        color: #ffffff;
    }
    .modal-header {
        background-color: #1a1d20;
        border-bottom-color: #495057;
    }
    .modal-footer {
        background-color: #1a1d20;
        border-top-color: #495057;
    }
    .modal-title {
        color: #ffffff;
    }
    .form-control {
        background-color: #2c3034;
        border-color: #495057;
        color: #ffffff;
    }
    .form-control:focus {
        background-color: #2c3034;
        border-color: #0dcaf0;
        color: #ffffff;
    }
    .form-control::placeholder {
        color: #adb5bd;
    }
    .input-group-text {
        background-color: #2c3034;
        border-color: #495057;
        color: #ffffff;
    }
    .form-label {
        color: #ffffff;
    }
    .fw-bold {
        color: #ffffff;
    }
    .text-primary {
        color: #0dcaf0 !important;
    }
    .alert-light {
        background-color: #2c3034;
        border-color: #495057;
        color: #ffffff;
    }
    .bg-light {
        background-color: #1a1d20 !important;
    }
    .text-muted {
        color: #ffffff !important;
    }
    .small {
        color: #ffffff;
    }
</style>
{% endblock %}

{% block content %}
<div class="container-fluid px-4 py-3">
    <div class="d-flex justify-content-between align-items-center mb-3">
        <h4 class="text-primary fw-bold mb-0">Inventory Management</h4>
        <a href="{{ url_for('add_item') }}" class="btn btn-primary btn-sm">
            <i class="fas fa-plus me-1"></i>New Item
        </a>
    </div>

    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="alert alert-{{ category if category != 'error' else 'danger' }} alert-dismissible fade show py-2" role="alert">
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
                </div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <div class="card shadow-sm">
        <div class="card-body p-0">
            <div class="table-responsive">
                <table class="table table-hover align-middle mb-0">
                    <thead class="bg-light">
                        <tr>
                            <th class="border-0 text-center">Item</th>
                            <th class="border-0 text-center">Seller</th>
                            <th class="border-0 text-center">Buyer</th>
                            <th class="border-0 text-center">Purchase</th>
                            <th class="border-0 text-center">Sale</th>
                            <th class="border-0 text-center">Specs</th>
                            <th class="border-0 text-center">Images</th>
                            <th class="border-0 text-center">Agreement</th>
                            <th class="border-0 text-center">Gross Profit</th>
                            <th class="border-0 text-center">Net Profit</th>
                            <th class="border-0 text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% if items %}
                            {% for item in items %}
                            <tr class="{% if item.selling_price %}sold-item{% endif %}">
                                <td class="text-center">{{ item.name }}</td>
                                <td class="text-center">
                                    <button class="btn btn-sm btn-outline-info" data-bs-toggle="modal" data-bs-target="#sellerModal{{ item.id }}">
                                        <i class="fas fa-user"></i>
                                    </button>
                                </td>
                                <td class="text-center">
                                    <button class="btn btn-sm btn-outline-info" data-bs-toggle="modal" data-bs-target="#buyerModal{{ item.id }}">
                                        <i class="fas fa-user"></i>
                                    </button>
                                </td>
                                <td class="text-center">
                                    <a href="#" class="text-decoration-none" data-bs-toggle="modal" data-bs-target="#purchaseDetailsModal{{ item.id }}">
                                        Rs. {{ "%.2f"|format(item.item_price) }}
                                    </a>
                                </td>
                                <td class="text-center">
                                    <a href="#" class="text-decoration-none" data-bs-toggle="modal" data-bs-target="#saleDetailsModal{{ item.id }}">
                                        Rs. {{ "%.2f"|format(item.selling_price) if item.selling_price else "00.00" }}
                                    </a>
                                </td>
                                <td class="text-center">
                                    <button class="btn btn-sm btn-outline-info" data-bs-toggle="modal" data-bs-target="#specsModal{{ item.id }}">
                                        <i class="fas fa-microchip"></i>
                                    </button>
                                </td>
                                <td class="text-center">
                                    {% set images = item.images|from_json %}
                                    {% if images %}
                                        <a href="{{ images[0]|replace('/view?usp=drivesdk', '') }}" target="_blank" class="btn btn-sm btn-outline-info">
                                            <i class="fas fa-images"></i>
                                        </a>
                                    {% else %}
                                        <button class="btn btn-sm btn-outline-secondary" disabled>
                                            <i class="fas fa-images"></i>
                                        </button>
                                    {% endif %}
                                </td>
                                <td class="text-center">
                                    {% if item.agreement_image %}
                                        <a href="{{ item.agreement_image|replace('/view?usp=drivesdk', '') }}" target="_blank" class="btn btn-sm btn-outline-info">
                                            <i class="fas fa-file-signature"></i>
                                        </a>
                                    {% else %}
                                        <button class="btn btn-sm btn-outline-secondary" disabled>
                                            <i class="fas fa-file-signature"></i>
                                        </button>
                                    {% endif %}
                                </td>
                                <td class="text-center">Rs. {{ "%.2f"|format(item.gross_profit) if item.gross_profit else "00.00" }}</td>
                                <td class="text-center">Rs. {{ "%.2f"|format(item.net_profit) if item.net_profit else "00.00" }}</td>
                                <td class="text-center">
                                    <div class="btn-group">
                                        {% if not item.selling_price %}
                                        <button class="btn btn-sm btn-outline-success" data-bs-toggle="modal" data-bs-target="#markSoldModal{{ item.id }}">
                                            <i class="fas fa-tag"></i>
                                        </button>
                                        {% endif %}
                                        <a href="{{ url_for('edit_item', item_id=item.id) }}" class="btn btn-sm btn-outline-warning">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        <button class="btn btn-sm btn-outline-danger" data-bs-toggle="modal" data-bs-target="#deleteModal{{ item.id }}">
                                            <i class="fas fa-trash"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>

                            <!-- Delete Confirmation Modal -->
                            <div class="modal fade" id="deleteModal{{ item.id }}" tabindex="-1">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header py-2 bg-light">
                                            <h6 class="modal-title fw-bold">Confirm Delete</h6>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>
                                        <div class="modal-body py-2">
                                            <p class="mb-0">Are you sure you want to delete "{{ item.name }}"? This action cannot be undone.</p>
                                        </div>
                                        <div class="modal-footer py-2 bg-light">
                                            <button type="button" class="btn btn-sm btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                            <form action="{{ url_for('delete_item', item_id=item.id) }}" method="POST" class="d-inline">
                                                <button type="submit" class="btn btn-sm btn-danger">Delete</button>
                                            </form>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Purchase Details Modal -->
                            <div class="modal fade" id="purchaseDetailsModal{{ item.id }}" tabindex="-1">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header py-2 bg-light">
                                            <h6 class="modal-title fw-bold">Purchase Details - {{ item.name }}</h6>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>
                                        <div class="modal-body py-2">
                                            <div class="row g-2">
                                                <div class="col-6">
                                                    <small class="fw-bold text-primary">Purchase Date</small>
                                                    <div class="fw-bold">{{ item.purchase_date }}</div>
                                                </div>
                                                <div class="col-6">
                                                    <small class="fw-bold text-primary">Item Price</small>
                                                    <div class="fw-bold">Rs. {{ "%.2f"|format(item.item_price) }}</div>
                                                </div>
                                                <div class="col-6">
                                                    <small class="fw-bold text-primary">Transport Cost</small>
                                                    <div class="fw-bold">Rs. {{ "%.2f"|format(item.transport_cost) }}</div>
                                                </div>
                                                <div class="col-6">
                                                    <small class="fw-bold text-primary">Food Cost</small>
                                                    <div class="fw-bold">Rs. {{ "%.2f"|format(item.food_cost) }}</div>
                                                </div>
                                                <div class="col-6">
                                                    <small class="fw-bold text-primary">Fuel Cost</small>
                                                    <div class="fw-bold">Rs. {{ "%.2f"|format(item.fuel_cost) }}</div>
                                                </div>
                                                <div class="col-6">
                                                    <small class="fw-bold text-primary">Other Expenses</small>
                                                    <div class="fw-bold">Rs. {{ "%.2f"|format(item.other_expenses) }}</div>
                                                </div>
                                                <div class="col-12 mt-2">
                                                    <div class="alert alert-light py-2 mb-0">
                                                        <div class="row g-2">
                                                            <div class="col-12">
                                                                <small class="fw-bold text-primary">Total Purchase Cost:</small>
                                                                <div class="fw-bold">Rs. {{ "%.2f"|format(item.item_price + item.transport_cost + item.food_cost + item.fuel_cost + item.other_expenses) }}</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Buyer Details Modal -->
                            <div class="modal fade" id="buyerModal{{ item.id }}" tabindex="-1">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header py-2 bg-light">
                                            <h6 class="modal-title fw-bold">Buyer Details - {{ item.name }}</h6>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>
                                        <div class="modal-body py-2">
                                            <!-- Debug output -->
                                            <div style="display: none;">
                                                Debug - Buyer Name: {{ item.buyer_name }}
                                                Debug - Buyer Contact: {{ item.buyer_contact }}
                                                Debug - Buyer Location: {{ item.buyer_location }}
                                                Debug - Buyer NIC: {{ item.buyer_nic }}
                                            </div>
                                            {% if item.buyer_name %}
                                                <div class="row g-2">
                                                    <div class="col-6">
                                                        <small class="fw-bold text-primary">Name</small>
                                                        <div class="fw-bold">{{ item.buyer_name }}</div>
                                                    </div>
                                                    <div class="col-6">
                                                        <small class="fw-bold text-primary">NIC</small>
                                                        <div class="fw-bold">{{ item.buyer_nic or 'N/A' }}</div>
                                                    </div>
                                                    <div class="col-6">
                                                        <small class="fw-bold text-primary">Contact</small>
                                                        <div class="fw-bold">{{ item.buyer_contact }}</div>
                                                    </div>
                                                    <div class="col-6">
                                                        <small class="fw-bold text-primary">Location</small>
                                                        <div class="fw-bold">{{ item.buyer_location }}</div>
                                                    </div>
                                                </div>
                                            {% else %}
                                                <p class="fw-bold text-center mb-0">Not yet sold</p>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Sale Details Modal -->
                            <div class="modal fade" id="saleDetailsModal{{ item.id }}" tabindex="-1">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header py-2 bg-light">
                                            <h6 class="modal-title fw-bold">Sale Details - {{ item.name }}</h6>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>
                                        <div class="modal-body py-2">
                                            {% if item.selling_price %}
                                            <div class="row g-2">
                                                <div class="col-12">
                                                    <h6 class="fw-bold text-primary mb-2">Sale Information</h6>
                                                    <div class="row g-2">
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">Selling Price</small>
                                                            <div class="fw-bold">Rs. {{ "%.2f"|format(item.selling_price) }}</div>
                                                        </div>
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">Sale Date</small>
                                                            <div class="fw-bold">{{ item.selling_date }}</div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-12">
                                                    <h6 class="fw-bold text-primary mb-2">Sale Expenses</h6>
                                                    <div class="row g-2">
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">Transport Cost</small>
                                                            <div class="fw-bold">Rs. {{ "%.2f"|format(item.transport_cost) }}</div>
                                                        </div>
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">Food Cost</small>
                                                            <div class="fw-bold">Rs. {{ "%.2f"|format(item.food_cost) }}</div>
                                                        </div>
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">Fuel Cost</small>
                                                            <div class="fw-bold">Rs. {{ "%.2f"|format(item.fuel_cost) }}</div>
                                                        </div>
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">Other Expenses</small>
                                                            <div class="fw-bold">Rs. {{ "%.2f"|format(item.other_expenses) }}</div>
                                                        </div>
                                                    </div>
                                                </div>

                                                <div class="col-12 mt-2">
                                                    <div class="alert alert-light py-2 mb-0">
                                                        <div class="row g-2">
                                                            <div class="col-6">
                                                                <small class="fw-bold text-primary">Gross Profit:</small>
                                                                <div class="fw-bold">Rs. {{ "%.2f"|format(item.gross_profit) }}</div>
                                                            </div>
                                                            <div class="col-6">
                                                                <small class="fw-bold text-primary">Net Profit:</small>
                                                                <div class="fw-bold">Rs. {{ "%.2f"|format(item.net_profit) }}</div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            {% else %}
                                            <p class="fw-bold text-center mb-0">Not yet sold</p>
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Mark as Sold Modal -->
                            <div class="modal fade" id="markSoldModal{{ item.id }}" tabindex="-1">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header py-2 bg-light">
                                            <h6 class="modal-title fw-bold">Mark as Sold - {{ item.name }}</h6>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>
                                        <form action="{{ url_for('mark_as_sold', item_id=item.id) }}" method="POST">
                                            <div class="modal-body">
                                                <div class="row g-3">
                                                    <div class="col-12">
                                                        <h6 class="fw-bold text-primary mb-2">Buyer Details</h6>
                                                        <div class="row g-2">
                                                            <div class="col-md-6">
                                                                <input type="text" class="form-control form-control-sm" placeholder="Buyer Name" name="buyer_name" required>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <input type="text" class="form-control form-control-sm" placeholder="Buyer Contact" name="buyer_contact" required>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <input type="text" class="form-control form-control-sm" placeholder="Buyer Location" name="buyer_location" required>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <input type="text" class="form-control form-control-sm" placeholder="Buyer NIC (Optional)" name="buyer_nic">
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="col-12">
                                                        <h6 class="fw-bold text-primary mb-2">Sale Details</h6>
                                                        <div class="row g-2">
                                                            <div class="col-md-6">
                                                                <input type="date" class="form-control form-control-sm" name="selling_date" required>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <div class="input-group input-group-sm">
                                                                    <span class="input-group-text">Rs.</span>
                                                                    <input type="number" class="form-control" placeholder="Selling Price" name="selling_price" step="0.01" required>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="col-12">
                                                        <h6 class="fw-bold text-primary mb-2">Sale Expenses</h6>
                                                        <div class="row g-2">
                                                            <div class="col-md-6">
                                                                <label class="form-label small text-muted">Transport Cost</label>
                                                                <div class="input-group input-group-sm">
                                                                    <span class="input-group-text">Rs.</span>
                                                                    <input type="number" class="form-control expense-input" name="transport_cost" step="0.01" value="0">
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <label class="form-label small text-muted">Fuel Cost</label>
                                                                <div class="input-group input-group-sm">
                                                                    <span class="input-group-text">Rs.</span>
                                                                    <input type="number" class="form-control expense-input" name="fuel_cost" step="0.01" value="0">
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <label class="form-label small text-muted">Food Cost</label>
                                                                <div class="input-group input-group-sm">
                                                                    <span class="input-group-text">Rs.</span>
                                                                    <input type="number" class="form-control expense-input" name="food_cost" step="0.01" value="0">
                                                                </div>
                                                            </div>
                                                            <div class="col-md-6">
                                                                <label class="form-label small text-muted">Other Expenses</label>
                                                                <div class="input-group input-group-sm">
                                                                    <span class="input-group-text">Rs.</span>
                                                                    <input type="number" class="form-control expense-input" name="other_expenses" step="0.01" value="0">
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>

                                                    <div class="col-12">
                                                        <div class="alert alert-light py-2 mb-0">
                                                            <div class="row g-2">
                                                                <div class="col-6">
                                                                    <small class="fw-bold text-primary">Purchase Price:</small>
                                                                    <div class="fw-bold">Rs.{{ "%.2f"|format(item.item_price) }}</div>
                                                                </div>
                                                                <div class="col-6">
                                                                    <small class="fw-bold text-primary">Total Expenses:</small>
                                                                    <div class="fw-bold">Rs.{{ "%.2f"|format(item.transport_cost + item.food_cost + item.fuel_cost + item.other_expenses) }}</div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="modal-footer py-2 bg-light">
                                                <button type="button" class="btn btn-sm btn-secondary" data-bs-dismiss="modal">Cancel</button>
                                                <button type="submit" class="btn btn-sm btn-success">Mark as Sold</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                            </div>

                            <!-- Seller Details Modal -->
                            <div class="modal fade" id="sellerModal{{ item.id }}" tabindex="-1">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header py-2 bg-light">
                                            <h6 class="modal-title fw-bold">Seller Details</h6>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>
                                        <div class="modal-body py-2">
                                            <div class="row g-2">
                                                <div class="col-6">
                                                    <small class="fw-bold text-primary">Name</small>
                                                    <div class="fw-bold">{{ item.seller_name }}</div>
                                                </div>
                                                <div class="col-6">
                                                    <small class="fw-bold text-primary">NIC</small>
                                                    <div class="fw-bold">{{ item.seller_nic }}</div>
                                                </div>
                                                <div class="col-6">
                                                    <small class="fw-bold text-primary">Contact</small>
                                                    <div class="fw-bold">{{ item.seller_contact }}</div>
                                                </div>
                                                <div class="col-6">
                                                    <small class="fw-bold text-primary">Location</small>
                                                    <div class="fw-bold">{{ item.seller_location }}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <!-- Specifications Modal -->
                            <div class="modal fade" id="specsModal{{ item.id }}" tabindex="-1">
                                <div class="modal-dialog modal-dialog-centered">
                                    <div class="modal-content">
                                        <div class="modal-header py-2 bg-light">
                                            <h6 class="modal-title fw-bold">Specifications - {{ item.name }}</h6>
                                            <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                                        </div>
                                        <div class="modal-body py-2">
                                            {% set specs = item.specifications|from_json %}
                                            <!-- Debug output -->
                                            <div style="display: none;">
                                                Debug - Raw specifications: {{ item.specifications }}
                                                Debug - Parsed specs: {{ specs|tojson }}
                                                Debug - Remarks value: {{ specs.remarks }}
                                                Debug - Remarks exists: {{ specs.remarks is not none }}
                                                Debug - Remarks empty: {{ specs.remarks == '' }}
                                                Debug - All specs keys: {{ specs.keys()|list }}
                                            </div>
                                            {% if item.item_type == 'laptop' %}
                                                <div class="row g-2">
                                                    {% if specs.cpu %}
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">CPU</small>
                                                            <div class="fw-bold">{{ specs.cpu }}</div>
                                                        </div>
                                                    {% endif %}
                                                    {% if specs.cpu_speed %}
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">CPU Speed</small>
                                                            <div class="fw-bold">{{ specs.cpu_speed }} GHz</div>
                                                        </div>
                                                    {% endif %}
                                                    {% if specs.ram_capacity %}
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">RAM</small>
                                                            <div class="fw-bold">{{ specs.ram_capacity }}GB {{ specs.ram_type }} {{ specs.ram_speed }}MHz</div>
                                                        </div>
                                                    {% endif %}
                                                    {% if specs.storage_size %}
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">Storage</small>
                                                            <div class="fw-bold">{{ specs.storage_size }} {{ specs.storage_type }}</div>
                                                        </div>
                                                    {% endif %}
                                                    {% if specs.gpu_type %}
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">GPU</small>
                                                            <div class="fw-bold">{{ specs.gpu_type }} {{ specs.gpu_memory }}</div>
                                                        </div>
                                                    {% endif %}
                                                    {% if specs.display_type %}
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">Display</small>
                                                            <div class="fw-bold">{{ specs.display_type }} {{ specs.display_resolution }}</div>
                                                        </div>
                                                    {% endif %}
                                                    {% if specs.features %}
                                                        <div class="col-12">
                                                            <small class="fw-bold text-primary">Features</small>
                                                            <div class="fw-bold">{{ specs.features|join(', ') }}</div>
                                                        </div>
                                                    {% endif %}
                                                </div>
                                            {% else %}
                                                <div class="row g-2">
                                                    {% if specs.model %}
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">Model</small>
                                                            <div class="fw-bold">{{ specs.model }}</div>
                                                        </div>
                                                    {% endif %}
                                                    {% if specs.capacity %}
                                                        <div class="col-6">
                                                            <small class="fw-bold text-primary">Capacity</small>
                                                            <div class="fw-bold">{{ specs.capacity }}</div>
                                                        </div>
                                                    {% endif %}
                                                </div>
                                            {% endif %}
                                            <div class="row mt-3">
                                                <div class="col-12">
                                                    <small class="fw-bold text-primary">Remarks/Damages</small>
                                                    <div class="fw-bold">{{ specs.remarks if specs.remarks else 'No remarks' }}</div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            {% endfor %}
                        {% else %}
                            <tr>
                                <td colspan="11" class="text-center py-4">
                                    <div class="fw-bold text-primary">No items found</div>
                                </td>
                            </tr>
                        {% endif %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
</div>

{% block scripts %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    // Calculate total expenses in mark as sold modal
    const expenseInputs = document.querySelectorAll('.expense-input');
    expenseInputs.forEach(input => {
        input.addEventListener('input', function() {
            let total = 0;
            expenseInputs.forEach(expense => {
                total += parseFloat(expense.value) || 0;
            });
        });
    });
});
</script>
{% endblock %}

{% endblock %} 